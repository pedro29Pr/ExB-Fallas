System.register(["jimu-core","jimu-ui","jimu-arcgis"],(function(e,t){var l={},n={},i={};return{setters:[function(e){l.BaseVersionManager=e.BaseVersionManager,l.Immutable=e.Immutable,l.React=e.React,l.ReactRedux=e.ReactRedux,l.UtilityManager=e.UtilityManager,l.appActions=e.appActions,l.classNames=e.classNames,l.css=e.css,l.defaultMessages=e.defaultMessages,l.esri=e.esri,l.jsx=e.jsx,l.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,l.lodash=e.lodash,l.moduleLoader=e.moduleLoader,l.polished=e.polished},function(e){n.Badge=e.Badge,n.Button=e.Button,n.Checkbox=e.Checkbox,n.Icon=e.Icon,n.Nav=e.Nav,n.NavItem=e.NavItem,n.NavLink=e.NavLink,n.Navbar=e.Navbar,n.NumericInput=e.NumericInput,n.Option=e.Option,n.Popper=e.Popper,n.Radio=e.Radio,n.SVG=e.SVG,n.Select=e.Select,n.TextInput=e.TextInput,n.WidgetPlaceholder=e.WidgetPlaceholder,n.defaultMessages=e.defaultMessages,n.getFallbackPlacementsModifier=e.getFallbackPlacementsModifier,n.hooks=e.hooks},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent,i.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules}],execute:function(){e((()=>{var e={60171:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.4.8V4h-.8A1.6 1.6 0 0 0 0 5.6v3.2a1.6 1.6 0 0 0 1.136 1.532c.249.075.464-.143.464-.403 0-.182-.154-.323-.32-.396A.8.8 0 0 1 .8 8.8V5.6a.8.8 0 0 1 .8-.8h12.8a.8.8 0 0 1 .8.8v3.2a.8.8 0 0 1-.48.733c-.166.073-.32.214-.32.396 0 .26.215.478.464.403A1.6 1.6 0 0 0 16 8.8V5.6A1.6 1.6 0 0 0 14.4 4h-.8V.8a.8.8 0 0 0-.8-.8H3.2a.8.8 0 0 0-.8.8Zm10.4 0H3.2V4h9.6V.8Z" fill="#C5C5C5"></path><path d="M5.2 10.4a.4.4 0 0 0 0 .8h5.6a.4.4 0 0 0 0-.8H5.2ZM5.2 12.8a.4.4 0 0 0 0 .8h3.2a.4.4 0 0 0 0-.8H5.2Z" fill="#C5C5C5"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M2.4 15.2V8.8H2A.4.4 0 0 1 2 8h12a.4.4 0 0 1 0 .8h-.4v6.4a.8.8 0 0 1-.8.8H3.2a.8.8 0 0 1-.8-.8Zm10.4-6.4v6.4H3.2V8.8h9.6Z" fill="#C5C5C5"></path><path d="M12 6c0-.22.18-.4.4-.4h.8a.4.4 0 0 1 0 .8h-.8A.4.4 0 0 1 12 6Z" fill="#C5C5C5"></path></svg>'},51513:e=>{e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.167 0H1.833A.845.845 0 0 0 1 .857v10.286c0 .473.373.857.833.857h8.334c.46 0 .833-.384.833-.857V.857A.845.845 0 0 0 10.167 0ZM2 11V1h8v10H2Zm1.6-8h4.8c.331 0 .6.224.6.5s-.269.5-.6.5H3.6c-.331 0-.6-.224-.6-.5s.269-.5.6-.5Zm4.8 3H3.6c-.331 0-.6.224-.6.5s.269.5.6.5h4.8c.331 0 .6-.224.6-.5S8.731 6 8.4 6Z" fill="#000"></path></svg>'},59788:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .538.538 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.538.538 0 0 1 0-.738Z" fill="#000"></path></svg>'},96009:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .538.538 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.538.538 0 0 1 0 .738Z" fill="#000"></path></svg>'},55339:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746L8.746 8Z" fill="#000"></path></svg>'},27218:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8Z" fill="#000"></path></svg>'},94539:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 4.796 4.796 4 8.02 7.224l3.184-3.184.796.796L8.816 8.02l3.144 3.144-.796.796L8.02 8.816 4.836 12l-.796-.796L7.224 8.02 4 4.796Z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="m0 4 4-4h8l4 4v8l-4 4H4l-4-4V4Zm1 .414L4.414 1h7.172L15 4.414v7.172L11.586 15H4.414L1 11.586V4.414Z" fill="#000"></path></svg>'},26826:e=>{"use strict";e.exports=i},48891:e=>{"use strict";e.exports=l},30726:e=>{"use strict";e.exports=n}},t={};function o(l){var n=t[l];if(void 0!==n)return n.exports;var i=t[l]={exports:{}};return e[l](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="";var a={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(a),o.d(a,{default:()=>Re});var e=o(48891),t=o(30726),l=o(26826);const n="CIMMarkerNorthArrow";var i,r;!function(e){e.CurrentMapExtent="CURRENT MAP EXTENT",e.CurrentMapScale="CURRENT MAP SCALE",e.SetMapScale="SET MAP SCALE"}(i||(i={})),function(e){e.Point="POINT",e.Inch="INCH",e.Centimeter="CENTIMETER",e.Millimeter="MILLIMETER"}(r||(r={}));const s={scalePreserved:!1,outScale:36978595.474472,layoutOptions:{titleText:"ArcGIS Web Map"},exportOptions:{dpi:96},printExtentType:i.CurrentMapExtent,attributionVisible:!1,forceFeatureAttributes:!0,wkid:102100,wkidLabel:"WGS_1984_Web_Mercator_Auxiliary_Sphere",enableTitle:!0,legendEnabled:!0,enableMapPrintExtents:!0,enableOutputSpatialReference:!0,enableQuality:!0,enableFeatureAttribution:!0,enableMapSize:!0,overrideCommonSetting:!1,enableAuthor:!0,enableCopyright:!0,enableLegend:!0,enableScalebarUnit:!0,enableCustomTextElements:!0};var u,d,c,v;!function(e){e.Classic="CLASSIC",e.Compact="COMPACT"}(u||(u={})),function(e){e.OrganizationService="ORGANIZATION SERVICE",e.Customize="CUSTOMIZE"}(d||(d={})),function(e){e.OrganizationTemplate="ORGANIZATION TEMPLATE",e.Customize="CUSTOMIZE"}(c||(c={})),function(e){e.Loading="LOADING",e.Success="SUCCESS",e.Error="ERROR"}(v||(v={}));var p=o(60171),m=o.n(p);const h={_widgetLabel:"Print",printPleaceholder:"Select or switch to a webmap to enable print.",chooseMapTip:"Please select a map with 2D data.",chooseUseUtility:"Please select utility.",printTemplate:"Print template",printResult:"Print result",previewPrint:"Preview print extents",fileFormat:"File format",mapPrintingExtents:"Map printing extents",outputSpatialReference:"Output spatial reference",printQuality:"Print quality",featureAttribution:"Feature attribution",selectEditableSettings:"Select editable settings",currentMapExtent:"Current map extent",currentMapScale:"Current map scale",setMapScale:"Set map scale",useCurrentScale:"Use current scale",wellKnownId:"Enter a well-known ID ({wkid})",allowEditing:"Select settings that allow editing at runtime",includeAttribution:"Include attribution",includeAttributes:"Include attributes",includeLegend:"Include legend",templateConfiguration:"Template configuration",templateName:"Template name",printLayout:"Layout",MapOnlyOptions:"Map-only options",LayoutOptions:"Layout options",mapSize:"Map size",spatialReference:"Output spatial reference {WKID}",printAuyhor:"Author",printCopyright:"Copyright",scaleBarUnit:"Scalebar unit",mapAttribution:"Map attribution",resultEmptyMessage:"Your printed files will appear here.",northArrow:"North arrow",includeNorthArrow:"Include north arrow"};var x,f=function(e,t,l,n){return new(l||(l=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function r(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(a,r)}s((n=n.apply(e,t||[])).next())}))};!function(e){e.AsynchronousSubmit="esriExecutionTypeAsynchronous",e.SynchronousExecute="esriExecutionTypeSynchronous"}(x||(x={}));const g=(t,l)=>{let n=l;return(null==t?void 0:t.exportOptions)&&(n=n.set("exportOptions",Object.assign(Object.assign({},t.exportOptions||{}),(null==l?void 0:l.exportOptions)||{}))),(null==t?void 0:t.layoutOptions)&&(null==l?void 0:l.layoutOptions)&&(n=n.set("layoutOptions",Object.assign(Object.assign({},(null==t?void 0:t.layoutOptions)||{}),(null==l?void 0:l.layoutOptions)||{}))),(0,e.Immutable)(Object.assign(Object.assign({},t),n))},y=(e,t)=>{let l;return null==e||e.forEach(((e,n)=>{(null==e?void 0:e.templateId)===t&&(l=n)})),l},b=e=>"map-only"===(e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.replace(/\_/gi,"-"))||void 0===t?void 0:t.replace(/\s+/gi,"-"))||void 0===l?void 0:l.toLowerCase()})(e),w=(e,t)=>{let l=!1;return null==e||e.forEach((e=>{(null==e?void 0:e.templateId)===t&&(l=!0)})),l},j=t=>f(void 0,void 0,void 0,(function*(){return e.UtilityManager.getInstance().getUrlOfUseUtility(t).then((e=>Promise.resolve(e)))}));function O(t){return f(this,void 0,void 0,(function*(){return(0,e.loadArcGISJSAPIModules)(["esri/rest/support/LegendLayer"]).then((e=>{var l,n,i;const[o]=e,a=S((null===(i=null===(n=null===(l=null==t?void 0:t.view)||void 0===l?void 0:l.map)||void 0===n?void 0:n.layers)||void 0===i?void 0:i.toArray())||[],o);return Promise.resolve(a)}))}))}function S(e,t){if(!e)return[];let l=[];null==e||e.forEach((e=>{var n;if("graphics"!==e.type&&e.visible&&(null==e?void 0:e.legendEnabled)){const i=(null==e?void 0:e.subLayerIds)||null;if("group"===(null==e?void 0:e.type)){const i=S((null===(n=null==e?void 0:e.layers)||void 0===n?void 0:n._items)||[],t)||[];l=l.concat(i)}const o=new t({layerId:null==e?void 0:e.id,title:null==e?void 0:e.title,subLayerIds:i});l.push(o)}}))}function N(e={}){var t;let l=null;for(const i in e)(null===(t=null==e?void 0:e[i])||void 0===t?void 0:t.type)===n&&(l=i);return l}var I=o(59788),T=o.n(I);const M=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:T()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var C=o(96009),P=o.n(C);const L=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:P()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var E=o(27218),k=o.n(E);const A=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:k()},i)):e.React.createElement("svg",Object.assign({className:o},i))},R=t=>{const{label:l,className:n,children:i,flowWrap:o}=t,a=e.css`
    .title {
      font-size: 14px;
    }
  `;return(0,e.jsx)("div",{className:(0,e.classNames)("mb-2 align-items-center",{className:n,"d-flex":!o}),css:a},(0,e.jsx)("div",{className:(0,e.classNames)("title flex-grow-1",{"mb-2":o})},l),i)};const z=(e,t)=>{let l=1,n=e;return t.forEach((i=>{n===(null==i?void 0:i.title)&&(n=`${e} (${l})`,l++,z(n,t))})),n},V=e=>{const t=(e=>{var t;return e?null===(t=null==e?void 0:e.asMutable())||void 0===t?void 0:t.map((e=>e.resultId)):[]})(e);return t&&0!==(null==t?void 0:t.length)?`config_${U(t)+1}`:"result_0"},U=e=>{var t;if(!e||0===(null==e?void 0:e.length))return 0;const l=null==e?void 0:e.map((e=>{var t;const l=null===(t=null==e?void 0:e.split("_"))||void 0===t?void 0:t.pop();return l?Number(l):0}));return null===(t=null==l?void 0:l.sort(((e,t)=>t-e)))||void 0===t?void 0:t[0]};function F(e,t){return"print-extents-layer-"+e+"-"+t}function B(e,t){var l,n,o,a,r,s,u,d,c,v;return u=this,d=void 0,v=function*(){const u=!1===(null==e?void 0:e.hasTitleText),d=!1===(null==e?void 0:e.hasLegend);let c=e.without("enableTitle","enableAuthor","enableOutputSpatialReference","enableMapPrintExtents","enableQuality","enableMapSize","enableFeatureAttribution","enableCopyright","enableLegend","enableMapAttribution","enableCustomTextElements","hasAuthorText","hasCopyrightText","hasLegend","hasTitleText","selectedFormatList","mapFrameSize","mapFrameUnit","legendEnabled","templateId","printExtentType","customTextElementEnableList");switch(null==e?void 0:e.printExtentType){case i.CurrentMapExtent:c=c.set("scalePreserved",!1);break;case i.CurrentMapScale:c=c.set("outScale",null===(l=null==t?void 0:t.view)||void 0===l?void 0:l.scale).set("scalePreserved",!0);break;case i.SetMapScale:c=c.set("scalePreserved",!0)}const v=null==c?void 0:c.asMutable({deep:!0});return u&&(null===(n=null==v?void 0:v.layoutOptions)||void 0===n||delete n.titleText),d&&(null===(o=null==v?void 0:v.layoutOptions)||void 0===o||delete o.legendLayers),(null===(a=null==e?void 0:e.layoutOptions)||void 0===a?void 0:a.legendLayers)&&(null===(s=null===(r=null==e?void 0:e.layoutOptions)||void 0===r?void 0:r.legendLayers)||void 0===s?void 0:s.length)>0?v.layoutOptions.legendLayers=yield O(t):v.layoutOptions.legendLayers=[],Promise.resolve(v)},new((c=void 0)||(c=Promise))((function(e,t){function l(e){try{i(v.next(e))}catch(e){t(e)}}function n(e){try{i(v.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c((function(e){e(i)}))).then(l,n)}i((v=v.apply(u,d||[])).next())}))}function $(e,t,l){const n=(i=l)?{XDPI:i,YDPI:i}:function(){const e={XDPI:null,YDPI:null},t=window.screen;if(null==t?void 0:t.XDPI)e.XDPI=null==t?void 0:t.deviceXDPI,e.YDPI=null==t?void 0:t.deviceYDPI;else{const t=document.createElement("div");t.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(t),e.XDPI=t.offsetWidth,e.YDPI=t.offsetHeight,t.parentNode.removeChild(t)}return e}();var i;return e/(t?n.XDPI:n.YDPI)*2.54/100}const{useState:G,useEffect:_,useRef:W}=e.React,D=l=>{var n,o,a,s;const{jimuMapView:u,id:d,selectedTemplate:c,className:v}=l,p=t.hooks.useTranslate(h,t.defaultMessages),m=W(null),x=W(null),f=W(null),g=W(null===(n=null==u?void 0:u.view)||void 0===n?void 0:n.extent),y=W(null===(o=null==u?void 0:u.view)||void 0===o?void 0:o.scale),w=e.css`

  `,[j,O]=G(!1),[S,N]=G(null===(a=null==u?void 0:u.view)||void 0===a?void 0:a.extent),[I,T]=G(null===(s=null==u?void 0:u.view)||void 0===s?void 0:s.scale);_((()=>(f.current=e.lodash.debounce(P,400),(0,e.loadArcGISJSAPIModules)(["esri/layers/GraphicsLayer","esri/Graphic","esri/geometry/Polygon","esri/geometry/Extent","esri/geometry/Point","esri/geometry/support/WKIDUnitConversion"]).then((e=>{m.current=e})),U)),[]),_((()=>{var e,t,l,n,i,o;const a=(null==c?void 0:c.templateId)!==(null===(e=x.current)||void 0===e?void 0:e.templateId),r=(null==c?void 0:c.printExtentType)!==(null===(t=x.current)||void 0===t?void 0:t.printExtentType),s=(null==c?void 0:c.outScale)!==(null===(l=x.current)||void 0===l?void 0:l.outScale),u=(null===(n=null==c?void 0:c.exportOptions)||void 0===n?void 0:n.dpi)!==(null===(o=null===(i=x.current)||void 0===i?void 0:i.exportOptions)||void 0===o?void 0:o.dpi),d=M();x.current=c,j&&(a||r||s||d||u)&&f.current()}),[c]),_((()=>{j&&S&&f.current()}),[S,I]),_((()=>{var t,l;u?(C(),N((0,e.Immutable)(JSON.parse(JSON.stringify(null===(l=null===(t=null==u?void 0:u.view)||void 0===t?void 0:t.extent)||void 0===l?void 0:l.toJSON()))))):N(null)}),[u]);const M=()=>{var e,t,l,n,i,o;if(!b(null==c?void 0:c.layout))return!1;const a=(null===(e=null==c?void 0:c.exportOptions)||void 0===e?void 0:e.width)!==(null===(l=null===(t=x.current)||void 0===t?void 0:t.exportOptions)||void 0===l?void 0:l.width),r=(null===(n=null==c?void 0:c.exportOptions)||void 0===n?void 0:n.height)!==(null===(o=null===(i=x.current)||void 0===i?void 0:i.exportOptions)||void 0===o?void 0:o.height);return a||r},C=()=>{var t,l;null===(t=null==u?void 0:u.view)||void 0===t||t.watch("extent",(t=>{const l=JSON.parse(JSON.stringify(t.toJSON()));N((0,e.Immutable)(l)),g.current=t})),null===(l=null==u?void 0:u.view)||void 0===l||l.watch("scale",(e=>{T(e),y.current=e}))},P=()=>{var e;const t=V(),l=new(0,m.current[1])((null===(e=x.current)||void 0===e?void 0:e.printExtentType)===i.CurrentMapExtent?E():L(),{type:"simple-fill",color:[0,216,237,.3],outline:{color:[0,0,0],width:"4px"}});t.graphics.removeAll(),t.graphics.add(l)},L=()=>{var e,t,l,n,o;const{mapFrameSize:a,mapFrameUnit:r,layout:s}=null===(e=x.current)||void 0===e?void 0:e.asMutable({deep:!0}),u=z(),d=R(r),c=m.current[2],v=b(s),p=null===(t=null==g?void 0:g.current)||void 0===t?void 0:t.center,h=(null===(l=x.current)||void 0===l?void 0:l.printExtentType)===i.SetMapScale?null===(n=x.current)||void 0===n?void 0:n.outScale:y.current,f=v?A():{width:a[0],height:a[1]},w={x:v?1:d.x/(null==u?void 0:u.x),y:v?1:d.y/(null==u?void 0:u.y)},j={x:f.width,y:f.height},O=(null==p?void 0:p.x)-(null==j?void 0:j.x)/2*h*(null==w?void 0:w.x),S=(null==p?void 0:p.y)-(null==j?void 0:j.y)/2*h*(null==w?void 0:w.y),N=(null==p?void 0:p.x)+(null==j?void 0:j.x)/2*h*(null==w?void 0:w.x),I=(null==p?void 0:p.y)+(null==j?void 0:j.y)/2*h*(null==w?void 0:w.y),T=[[O,S],[O,I],[N,I],[N,S],[O,S]],M=new c({spatialReference:null===(o=null==g?void 0:g.current)||void 0===o?void 0:o.spatialReference});return M.addRing(T),M},E=()=>{var t,l,n,i,o,a;const r=m.current[3],{mapFrameSize:s,layout:d,exportOptions:c}=null===(t=x.current)||void 0===t?void 0:t.asMutable({deep:!0}),v=b(d),p=m.current[2];let h=(0,e.Immutable)(null===(l=g.current)||void 0===l?void 0:l.toJSON());const f=(null===(n=null==u?void 0:u.view)||void 0===n?void 0:n.width)/(null===(i=null==u?void 0:u.view)||void 0===i?void 0:i.height),y=v?(null==c?void 0:c.width)/(null==c?void 0:c.height):s[0]/s[1],w=(null==h?void 0:h.height)||(null===(o=null==u?void 0:u.view)||void 0===o?void 0:o.height),j=(null==h?void 0:h.width)||(null===(a=null==u?void 0:u.view)||void 0===a?void 0:a.width);if(f>y){const e=j/y,t=k(!1,e/w);h=h.set("height",e).set("ymin",null==t?void 0:t.mim).set("ymax",null==t?void 0:t.max)}else if(f<y){const e=w*y,t=k(!0,e/j);h=h.set("width",e).set("xmin",null==t?void 0:t.mim).set("xmax",null==t?void 0:t.max)}const O=new r({xmax:null==h?void 0:h.xmax,xmin:null==h?void 0:h.xmin,ymax:null==h?void 0:h.ymax,ymin:null==h?void 0:h.ymin,zmax:null==h?void 0:h.zmax,zmin:null==h?void 0:h.zmin,spatialReference:null==h?void 0:h.spatialReference});return p.fromExtent(O)},k=(e,t)=>{var l,n;const i=null===(l=g.current)||void 0===l?void 0:l.toJSON(),o=null===(n=null==g?void 0:g.current)||void 0===n?void 0:n.center,a=(e?(null==i?void 0:i.xmax)-(null==i?void 0:i.xmin):(null==i?void 0:i.ymax)-(null==i?void 0:i.ymin))*t;return{max:e?(null==o?void 0:o.x)+a/2:(null==o?void 0:o.y)+a/2,mim:e?(null==o?void 0:o.x)-a/2:(null==o?void 0:o.y)-a/2}},A=()=>{var e;const{exportOptions:t}=null===(e=x.current)||void 0===e?void 0:e.asMutable({deep:!0}),l=z();return{width:$(null==t?void 0:t.width,!0,null==t?void 0:t.dpi)*(null==l?void 0:l.x),height:$(null==t?void 0:t.height,!1,null==t?void 0:t.dpi)*(null==l?void 0:l.y)}},R=e=>{switch(null==e?void 0:e.toUpperCase()){case r.Centimeter:return{x:.01,y:.01};case r.Inch:return{x:.0254,y:.0254};case r.Millimeter:return{x:.001,y:.001};case r.Point:return{x:.0254/72,y:.0254/72};default:return{x:NaN,y:NaN}}},z=()=>{var e;const t=m.current[5];let l,n;const i=null===(e=null==g?void 0:g.current)||void 0===e?void 0:e.spatialReference;i&&(l=i.wkid,n=i.wkt);let o=null;if(l)o=t.values[t[l]];else if(n&&-1!==n.search(/^PROJCS/i)){const e=/UNIT\[([^\]]+)\]\]$/i.exec(n);e&&e[1]&&(o=parseFloat(e[1].split(",")[1]))}return{x:o,y:o}},V=()=>{var e;let t=null;const l=m.current[0],n=F(d,u.id);return(null===(e=u.view)||void 0===e?void 0:e.map)&&(t=u.view.map.findLayerById(n),t||(t=new l({id:n,listMode:"hide",title:n}),u.view.map.add(t))),t},U=()=>{const e=F(d,u.id),t=u.view.map.findLayerById(e);t&&t.graphics.removeAll()};return(0,e.jsx)("div",{className:v,css:w},(0,e.jsx)(t.Button,{title:p("previewPrint"),className:"d-flex w-100 align-items-center checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:()=>{O(!j),j?U():P()}},(0,e.jsx)(t.Checkbox,{title:p("previewPrint"),className:"lock-item-ratio","data-field":"mapSize",checked:j}),(0,e.jsx)("div",{className:"text-left ml-2 text-truncate"},p("previewPrint"))))};var J=function(e,t,l,n){return new(l||(l=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function r(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(a,r)}s((n=n.apply(e,t||[])).next())}))};const Z=new(0,e.esri.Sanitizer),{useState:H,useEffect:Q,useRef:K}=e.React,X=l=>{var n,o,a,r,s,u,d,c;const v=t.hooks.useTranslate(h,t.defaultMessages,e.defaultMessages),p=K(null),m=K(null),x=K(!1),f=e.css`
    padding-bottom: ${e.polished.rem(16)};
    padding-top: ${e.polished.rem(16)};
    .setting-con {
      overflow-y: auto;
      padding-left: ${e.polished.rem(16)};
      padding-right: ${e.polished.rem(16)};
    }
    .print-button-con {
      padding-left: ${e.polished.rem(16)};
      padding-right: ${e.polished.rem(16)};
    }
    .no-right-padding .jimu-interactive-node{
      padding-right: 0;
    }
    .scalebar-unit {
      width: ${e.polished.rem(160)};
    }
    .collapse-button {
      padding-right: 0;
    }
    .map-size-con input {
      width: 100%;
    }
    .wkid-describtion {
      font-size: ${e.polished.rem(12)};
      color: var(--dark-400);
    }
    .wkid-describtion-invalid {
      color: var(--danger-700)
    }
    .outscale-con, .dpi-con {
      input {
        border-right: 0;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }
      button {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        height: ${e.polished.rem(26)};
        svg {
          margin-right: 0;
        }
      }
    }
  `,{templateList:g,jimuMapView:w,selectedTemplate:j,id:S,confirmPrint:I,handleSelectedTemplateChange:T,setSelectedTemplateByIndex:C}=l,[P,E]=H((null===(n=null==j?void 0:j.layoutOptions)||void 0===n?void 0:n.titleText)||""),[k,z]=H((null==j?void 0:j.wkid)||""),[V,U]=H(null==j?void 0:j.outScale),[F,B]=H((null===(o=null==j?void 0:j.layoutOptions)||void 0===o?void 0:o.authorText)||""),[$,G]=H((null===(a=null==j?void 0:j.layoutOptions)||void 0===a?void 0:a.copyrightText)||""),[_,W]=H(null===(r=null==j?void 0:j.layoutOptions)||void 0===r?void 0:r.customTextElements),[X,q]=e.React.useState(null===(s=null==j?void 0:j.exportOptions)||void 0===s?void 0:s.dpi),[Y,ee]=e.React.useState(null===(u=null==j?void 0:j.exportOptions)||void 0===u?void 0:u.width),[te,le]=e.React.useState(null===(d=null==j?void 0:j.exportOptions)||void 0===d?void 0:d.height),[ne,ie]=H(!1),[oe,ae]=e.React.useState(null),[re,se]=H(null),[ue,de]=H(!1),[ce,ve]=H(!1);Q((()=>{var e,t,l,n,i,o,a,r,s,u,d,c,v,h;E((null===(e=null==j?void 0:j.layoutOptions)||void 0===e?void 0:e.titleText)||""),B((null===(t=null==j?void 0:j.layoutOptions)||void 0===t?void 0:t.authorText)||""),G((null===(l=null==j?void 0:j.layoutOptions)||void 0===l?void 0:l.copyrightText)||""),W(null===(n=null==j?void 0:j.layoutOptions)||void 0===n?void 0:n.customTextElements),z(null==j?void 0:j.wkid),p.current=null==j?void 0:j.wkid,U(null==j?void 0:j.outScale),q(null===(i=null==j?void 0:j.exportOptions)||void 0===i?void 0:i.dpi),ee(null===(o=null==j?void 0:j.exportOptions)||void 0===o?void 0:o.width),le(null===(a=null==j?void 0:j.exportOptions)||void 0===a?void 0:a.height),se(N(null===(r=null==j?void 0:j.layoutOptions)||void 0===r?void 0:r.elementOverrides)),Be(ne),de(!!(null===(s=null==j?void 0:j.layoutOptions)||void 0===s?void 0:s.legendLayers)||(null===(d=null===(u=null==j?void 0:j.layoutOptions)||void 0===u?void 0:u.legendLayers)||void 0===d?void 0:d.length)>0),ve(null===(h=null===(v=null===(c=null==j?void 0:j.layoutOptions)||void 0===c?void 0:c.elementOverrides)||void 0===v?void 0:v[re])||void 0===h?void 0:h.visible),(null==j?void 0:j.wkidLabel)?ae(null==j?void 0:j.wkidLabel):m.current&&pe(null==j?void 0:j.wkid).then((e=>{ae(e)}))}),[j]);const pe=t=>J(void 0,void 0,void 0,(function*(){if(x.current){const{getSRLabel:e}=m.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{m.current=e,x.current=!0;const{getSRLabel:l}=m.current;return Promise.resolve(l(t))}))})),me=t=>J(void 0,void 0,void 0,(function*(){if(x.current){const{isValidWkid:e}=m.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{m.current=e,x.current=!0;const{isValidWkid:l}=m.current;return Promise.resolve(l(t))}))})),he=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value,n=y(null==g?void 0:g.asMutable({deep:!0}),l);C(n)},xe=(e,t)=>{const l=j.setIn(e,t);T(l)},fe=()=>{xe(["forceFeatureAttributes"],!(null==j?void 0:j.forceFeatureAttributes))},ge=()=>{xe(["attributionVisible"],!(null==j?void 0:j.attributionVisible))},ye=e=>J(void 0,void 0,void 0,(function*(){const e=ue?null:yield O(w);xe(["layoutOptions","legendLayers"],e),de(!ue)})),be=()=>{var e,t,l;const n=null===(l=null===(t=null===(e=null==j?void 0:j.layoutOptions)||void 0===e?void 0:e.elementOverrides)||void 0===t?void 0:t[re])||void 0===l?void 0:l.visible;xe(["layoutOptions","elementOverrides",re,"visible"],!n)},we=e=>{xe(["layoutOptions","titleText"],e)},je=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;E(l)},Oe=e=>J(void 0,void 0,void 0,(function*(){if(!(yield me(e))){z(p.current);const e=yield pe(p.current);return ae(e),!1}p.current=e;const t=yield pe(e),l=j.set("wkid",e).set("wkidLabel",t);T(l)})),Se=e=>J(void 0,void 0,void 0,(function*(){if(yield me(e)){const t=yield pe(e);ae(t)}else ae(v("invalidWKID"));z(e)})),Ne=e=>{xe(["outScale"],e)},Ie=()=>{var e;const t=null===(e=null==w?void 0:w.view)||void 0===e?void 0:e.scale;U(t),xe(["outScale"],t)},Te=e=>{U(e)},Me=e=>{xe(["layoutOptions","authorText"],e)},Ce=e=>{if(e<1)return!1;q(parseInt(e))},Pe=e=>{if(e<1)return!1;xe(["exportOptions","dpi"],parseInt(e))},Le=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;B(l)},Ee=e=>{xe(["layoutOptions","copyrightText"],e)},ke=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;G(l)},Ae=e=>{var t;if(!e||Number(e)<1)return ee(null===(t=null==j?void 0:j.exportOptions)||void 0===t?void 0:t.width),!1;xe(["exportOptions","width"],e)},Re=e=>{ee(e)},ze=e=>{var t;if(!e||Number(e)<1)return le(null===(t=null==j?void 0:j.exportOptions)||void 0===t?void 0:t.height),!1;xe(["exportOptions","height"],e)},Ve=e=>{le(e)},Ue=e=>{const t=e.target.value;xe(["format"],t)},Fe=e=>{const t=e.target.value;xe(["layoutOptions","scalebarUnit"],t)},Be=e=>{const t=We(),{showOutputSpatialReference:l}=t;e&&l&&!(null==j?void 0:j.wkidLabel)&&J(void 0,void 0,void 0,(function*(){const e=yield pe(null==j?void 0:j.wkid);ae(e)}))},$e=()=>{Be(!ne),ie(!ne)},Ge=e=>{var t;if(e===i.SetMapScale){const l=null===(t=null==w?void 0:w.view)||void 0===t?void 0:t.scale;U(l),xe(["outScale"],l);const n=j.set("outScale",l).set("printExtentType",e);T(n)}else xe(["printExtentType"],e)},_e=e=>{if(m.current){const{isValidWkid:t}=m.current;return t(e)}return!0},We=()=>{const e=b(null==j?void 0:j.layout),t=(null==j?void 0:j.hasAuthorText)&&(null==j?void 0:j.enableAuthor)&&!e,l=(null==j?void 0:j.hasCopyrightText)&&(null==j?void 0:j.enableCopyright)&&!e,n=(null==j?void 0:j.hasLegend)&&(null==j?void 0:j.enableLegend)&&!e,i=De()&&!e;return{showLayoutOption:t||l||n||i||(null==j?void 0:j.enableScalebarUnit),showAuthor:t,showCopyright:l,showLegend:n,showCustomTextElements:i,showTitle:null==j?void 0:j.enableTitle,showFeatureAttribution:null==j?void 0:j.enableFeatureAttribution,showMapAttribution:(null==j?void 0:j.enableMapAttribution)&&e,showQuality:null==j?void 0:j.enableQuality,showMapSize:(null==j?void 0:j.enableMapSize)&&e,showMapPrintExtents:null==j?void 0:j.enableMapPrintExtents,showScalebarUnit:(null==j?void 0:j.enableScalebarUnit)&&!e,showOutputSpatialReference:null==j?void 0:j.enableOutputSpatialReference,showNorthArrow:null==j?void 0:j.enableNorthArrow}},De=()=>{var e,t;const l=[];return null===(e=null==j?void 0:j.customTextElementEnableList)||void 0===e||e.forEach((e=>{for(const t in e)l.push(e[t])})),(null===(t=null==l?void 0:l.filter((e=>e)))||void 0===t?void 0:t.length)>0},Je=()=>{const l=[];return null==_||_.forEach(((n,i)=>{var o,a;for(const r in n){if(!(null===(a=null===(o=null==j?void 0:j.customTextElementEnableList)||void 0===o?void 0:o[i])||void 0===a?void 0:a[r]))continue;const s=(0,e.jsx)(R,{flowWrap:!0,className:"align-item-center",label:r,key:`${r}_${i}`},(0,e.jsx)(t.TextInput,{size:"sm",className:"flex-grow-1",value:n[r]||"",onAcceptValue:e=>{Ze(i,r,e)},onChange:e=>{He(i,r,e)},"aria-label":r}));l.push(s)}})),l},Ze=(e,t,l)=>{const n=_[e].set(t,l),i=null==_?void 0:_.asMutable({deep:!0});i.splice(e,1,n),xe(["layoutOptions","customTextElements"],i)},He=(t,l,n)=>{var i;const o=null===(i=null==n?void 0:n.target)||void 0===i?void 0:i.value,a=_[t].set(l,o),r=null==_?void 0:_.asMutable({deep:!0});r.splice(t,1,a),W((0,e.Immutable)(r))};return(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column",css:f},(0,e.jsx)("div",{className:"flex-grow-1 w-100 setting-con"},(0,e.jsx)("div",{className:"w-100 h-100"},(()=>{var l,n,i;const o=We(),{showTitle:a}=o;return(0,e.jsx)("div",{className:"base-setting-con"},a&&(0,e.jsx)(R,{flowWrap:!0,label:v("title")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100",value:P,"aria-label":v("title"),onAcceptValue:we,onChange:je})),(0,e.jsx)(R,{flowWrap:!0,label:v("template")},(0,e.jsx)(t.Select,{value:null==j?void 0:j.templateId,onChange:he,size:"sm","aria-label":v("template")},null==g?void 0:g.map(((l,n)=>(0,e.jsx)(t.Option,{key:null==l?void 0:l.templateId,value:null==l?void 0:l.templateId,title:null==l?void 0:l.label},null==l?void 0:l.label))))),(null===(l=null==j?void 0:j.selectedFormatList)||void 0===l?void 0:l.length)>1&&(0,e.jsx)(R,{flowWrap:!0,label:v("fileFormat")},(0,e.jsx)(t.Select,{value:null===(n=null==j?void 0:j.format)||void 0===n?void 0:n.toLowerCase(),onChange:Ue,size:"sm","aria-label":v("fileFormat")},null===(i=null==j?void 0:j.selectedFormatList)||void 0===i?void 0:i.map(((l,n)=>(0,e.jsx)(t.Option,{key:`format${n}`,value:l,title:l},l))))))})(),(0,e.jsx)("div",null,b(null==j?void 0:j.layout)&&(()=>{const l=We(),{showMapSize:n}=l;return(0,e.jsx)("div",null,n&&(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)("div",{className:"flex-grow-1"},(0,e.jsx)("div",{className:"mb-1"},v("width")),(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 map-size-con",value:Y,onAcceptValue:Ae,onChange:Re,showHandlers:!1,"aria-label":v("width")})),(0,e.jsx)("div",{className:"flex-grow-1 ml-2"},(0,e.jsx)("div",{className:"mb-1"},v("height")),(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 map-size-con",value:te,onAcceptValue:ze,onChange:Ve,showHandlers:!1,"aria-label":v("height")}))))})(),(()=>{const l=b(null==j?void 0:j.layout),n=We(),{showLayoutOption:o,showFeatureAttribution:a,showMapAttribution:r,showQuality:s,showMapSize:u,showMapPrintExtents:d,showScalebarUnit:c,showOutputSpatialReference:p}=n,m=o||a||r||s||u||d||c||p;return(0,e.jsx)("div",null,m&&(0,e.jsx)("div",{className:"d-flex align-items-center",role:"group","aria-label":v("advance")},(0,e.jsx)("div",{className:"flex-grow-1"},v("advance")),(0,e.jsx)(t.Button,{className:"collapse-button",size:"sm",type:"tertiary",onClick:$e,title:v("advance")},ne?(0,e.jsx)(L,null):(0,e.jsx)(M,null))),ne&&(0,e.jsx)("div",null,d&&(0,e.jsx)(R,{flowWrap:!0,label:v("mapPrintingExtents")},(0,e.jsx)(t.Button,{title:v("currentMapExtent"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con mt-1 checkbox-con",onClick:()=>{Ge(i.CurrentMapExtent)}},(0,e.jsx)(t.Radio,{title:v("currentMapExtent"),checked:(null==j?void 0:j.printExtentType)===i.CurrentMapExtent,className:"mr-2"})," ",v("currentMapExtent")),(0,e.jsx)(t.Button,{title:v("currentMapScale"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con checkbox-con",onClick:()=>{Ge(i.CurrentMapScale)}},(0,e.jsx)(t.Radio,{title:v("currentMapScale"),checked:(null==j?void 0:j.printExtentType)===i.CurrentMapScale,className:"mr-2"})," ",v("currentMapScale")),(0,e.jsx)(t.Button,{title:v("setMapScale"),type:"tertiary",style:{paddingLeft:0,paddingRight:0},className:"d-flex align-items-center radio-con checkbox-con",onClick:()=>{Ge(i.SetMapScale)}},(0,e.jsx)(t.Radio,{title:v("setMapScale"),checked:(null==j?void 0:j.printExtentType)===i.SetMapScale,className:"mr-2"})," ",v("setMapScale")),(null==j?void 0:j.printExtentType)===i.SetMapScale&&(0,e.jsx)("div",{className:"w-100 d-flex align-items-center outscale-con"},(0,e.jsx)(t.NumericInput,{size:"sm",className:"flex-grow-1 dpi-input no-right-padding",value:V,onAcceptValue:Ne,onChange:Te,showHandlers:!1,"aria-label":v("setMapScale")}),(0,e.jsx)(t.Button,{size:"sm",onClick:Ie,title:v("useCurrentScale")},(0,e.jsx)(A,null)))),p&&(0,e.jsx)(R,{flowWrap:!0,label:(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:Z.sanitize(v("spatialReference",{WKID:'<a target="_blank" href="https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references.htm">WKID</a>'}))}})},(0,e.jsx)(t.NumericInput,{size:"sm",className:"w-100 dpi-input no-right-padding",value:k,onAcceptValue:Oe,onChange:Se,showHandlers:!1,"aria-label":v("spatialReference",{WKID:""})}),(0,e.jsx)("div",{title:oe,"aria-label":oe,className:(0,e.classNames)("text-truncate mt-1 wkid-describtion",{"wkid-describtion-invalid":!_e(Number(k))})},oe)),!l&&(()=>{var l;const n=We(),{showAuthor:i,showCopyright:o,showLegend:a,showLayoutOption:r,showFeatureAttribution:s,showQuality:u,showScalebarUnit:d,showNorthArrow:c}=n;return(0,e.jsx)("div",null,r&&(0,e.jsx)("div",{className:"mb-2"},v("LayoutOptions")),i&&(0,e.jsx)(R,{flowWrap:!0,label:v("printAuyhor")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 dpi-input",value:F,onAcceptValue:Me,onChange:Le,"aria-label":v("printAuyhor")})),o&&(0,e.jsx)(R,{flowWrap:!0,label:v("printCopyright")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 dpi-input",value:$,onAcceptValue:Ee,onChange:ke,"aria-label":v("printCopyright")})),Je(),a&&(0,e.jsx)(R,null,(0,e.jsx)(t.Button,{title:v("includeLegend"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:ye},(0,e.jsx)(t.Checkbox,{title:v("includeLegend"),className:"lock-item-ratio",checked:ue}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeLegend")))),c&&(0,e.jsx)(R,null,(0,e.jsx)(t.Button,{title:v("includeNorthArrow"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:be},(0,e.jsx)(t.Checkbox,{title:v("includeNorthArrow"),className:"lock-item-ratio",checked:ce}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeNorthArrow")))),d&&(0,e.jsx)(R,{label:v("scaleBarUnit"),flowWrap:!1},(0,e.jsx)(t.Select,{value:null===(l=null==j?void 0:j.layoutOptions)||void 0===l?void 0:l.scalebarUnit,onChange:Fe,size:"sm",className:"scalebar-unit","aria-label":v("scaleBarUnit")},function(e){return[{value:"Miles",label:e("unitsLabelMiles")},{value:"Kilometers",label:e("unitsLabelKilometers")},{value:"Meters",label:e("unitsLabelMeters")},{value:"Feet",label:e("unitsLabelFeet")}]}(v).map(((l,n)=>(0,e.jsx)(t.Option,{key:`unit${n}`,value:l.value,title:l.label},l.label))))),u&&(0,e.jsx)(R,{label:v("printQuality"),flowWrap:!0},(0,e.jsx)("div",{className:"d-flex align-items-center w-100 dpi-con"},(0,e.jsx)(t.NumericInput,{size:"sm",className:"flex-grow-1 no-right-padding",value:X,onAcceptValue:Pe,onChange:Ce,showHandlers:!1,"aria-label":v("printQuality")}),(0,e.jsx)(t.Button,{disabled:!0,size:"sm",title:"DPI"},"DPI"))),s&&(0,e.jsx)(R,null,(0,e.jsx)(t.Button,{title:v("includeAttributes"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:fe},(0,e.jsx)(t.Checkbox,{title:v("includeAttributes"),className:"lock-item-ratio","data-field":"mapSize",checked:null==j?void 0:j.forceFeatureAttributes}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttributes")))))})(),l&&(()=>{const l=We(),{showFeatureAttribution:n,showMapAttribution:i,showQuality:o}=l;return(0,e.jsx)("div",null,n&&(0,e.jsx)(R,{className:"mb-1"},(0,e.jsx)(t.Button,{title:v("includeAttributes"),className:"w-100 align-items-center mt-1 d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:fe},(0,e.jsx)(t.Checkbox,{title:v("includeAttributes"),className:"lock-item-ratio","data-field":"mapSize",checked:null==j?void 0:j.forceFeatureAttributes}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttributes")))),i&&(0,e.jsx)(R,null,(0,e.jsx)(t.Button,{title:v("includeAttribution"),className:"w-100 align-items-center d-flex checkbox-con",type:"tertiary",style:{paddingLeft:0,paddingRight:0},onClick:ge},(0,e.jsx)(t.Checkbox,{title:v("includeAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:null==j?void 0:j.attributionVisible}),(0,e.jsx)("div",{className:"text-left ml-2 f-grow-1"},v("includeAttribution")))),o&&(0,e.jsx)(R,{flowWrap:!0,label:v("printQuality")},(0,e.jsx)(t.TextInput,{size:"sm",className:"w-100 no-right-padding",value:X,onAcceptValue:Pe,onChange:Ce,suffix:(0,e.jsx)(t.Button,{disabled:!0,size:"sm"},"DPI")})))})()))})()))),(0,e.jsx)("div",{className:"print-button-con"},(0,e.jsx)(D,{id:S,jimuMapView:w,className:"w-100",scale:V,selectedTemplate:j,scalebarUnit:null===(c=null==j?void 0:j.layoutOptions)||void 0===c?void 0:c.scalebarUnit,printExtentType:null==j?void 0:j.printExtentType}),(0,e.jsx)(t.Button,{className:"w-100 mt-2",type:"primary",onClick:()=>{I(j)}},v("_widgetLabel"))))};var q=o(55339),Y=o.n(q);const ee=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:Y()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var te=o(51513),le=o.n(te);const ne=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:le()},i)):e.React.createElement("svg",Object.assign({className:o},i))};var ie=o(94539),oe=o.n(ie);const ae=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:oe()},i)):e.React.createElement("svg",Object.assign({className:o},i))},re=l=>{const n=t.hooks.useTranslate(h,t.defaultMessages),i=e.css`
    & {
      overflow: auto;
      padding: ${e.polished.rem(16)} ${e.polished.rem(16)} ${e.polished.rem(16)} ${e.polished.rem(16)};
    }
    button {
      padding-left: 0;
      padding-right: 0;
    }
    a {
      padding: 0;
    }
    .print-loading-con {
      @keyframes loading {
        0% {transform: rotate(0deg); };
        100% {transform: rotate(360deg)};
      }
      width: ${e.polished.rem(16)};
      height: ${e.polished.rem(16)};
      border: 1px solid var(--dark-100);
      border-radius: 50%;
      border-top: 1px solid var(--dark-800);
      box-sizing: border-box;
      animation:loading 2s infinite linear;
      margin-right: ${e.polished.rem(4)};
    }
    .error-link, .error-link:hover {
      color: var(--dark);
      & svg {
        color: var(--danger-800);
      }
    }
  `,{printResultList:o,deleteResultItem:a}=l;return(0,e.jsx)("div",{className:"w-100 h-100",css:i},0===(null==o?void 0:o.length)&&(0,e.jsx)("div",null,n("resultEmptyMessage")),o.map(((l,i)=>(0,e.jsx)("div",{className:"d-flex align-items-center mb-2 w-100",key:null==l?void 0:l.resultId},(0,e.jsx)(t.Button,{href:null==l?void 0:l.url,disabled:!(null==l?void 0:l.url),target:"_blank",size:"sm","aria-label":null==l?void 0:l.title,title:(null==l?void 0:l.state)!==v.Error?null==l?void 0:l.title:"",type:"tertiary",className:(0,e.classNames)("flex-grow-1 d-flex align-items-center",{"error-link":(null==l?void 0:l.state)===v.Error})},(t=>{switch(t.state){case v.Loading:return(0,e.jsx)("div",{className:"print-loading-con"});case v.Success:return(0,e.jsx)(ne,null);case v.Error:return(0,e.jsx)("span",{title:n("uploadImageError")},(0,e.jsx)(ae,null))}})(l),(0,e.jsx)("div",{className:"ml-2",title:(null==l?void 0:l.state)===v.Error?null==l?void 0:l.title:""},null==l?void 0:l.title)),(0,e.jsx)(t.Button,{size:"sm",type:"tertiary",onClick:()=>{a(i)},title:n("remove")},(0,e.jsx)(ee,null))))))};const se=e=>{return t=void 0,n=void 0,o=function*(){const{mapView:t,printTemplateProperties:n,useUtility:i}=e;return j(i).then((e=>(0,l.loadArcGISJSAPIModules)(["esri/rest/support/PrintParameters","esri/rest/support/PrintTemplate","esri/rest/print","esri/geometry/SpatialReference"]).then((l=>{var i;const[o,a,r,s]=l,u=new a(n),d=function(e){var t,l;return e.layerViews.items=null===(l=null===(t=null==e?void 0:e.layerViews)||void 0===t?void 0:t.items)||void 0===l?void 0:l.map((e=>{var t,l,n,i,o,a,r;return(null===(l=null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.id)||void 0===l?void 0:l.includes("jimu-draw-layer-"))||(null===(i=null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.id)||void 0===i?void 0:i.includes("bookmark-layer-"))?(e.graphicsView.graphics.items=null===(r=null===(a=null===(o=null==e?void 0:e.graphicsView)||void 0===o?void 0:o.graphics)||void 0===a?void 0:a.items)||void 0===r?void 0:r.map((e=>{var t;return(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t.jimuDrawId)?(e.geometry.hasZ=!1,e):e})),e):e})),e}(t),c={view:d,template:u};n.wkid!==(null===(i=null==t?void 0:t.spatialReference)||void 0===i?void 0:i.wkid)&&(c.outSpatialReference=new s({wkid:n.wkid}));const v=new o(c);return r.execute(e,v).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))}))))},new((i=void 0)||(i=Promise))((function(e,l){function a(e){try{s(o.next(e))}catch(e){l(e)}}function r(e){try{s(o.throw(e))}catch(e){l(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof i?l:new i((function(e){e(l)}))).then(a,r)}s((o=o.apply(t,n||[])).next())}));var t,n,i,o};const{useState:ue,useRef:de,useEffect:ce}=e.React;var ve;!function(e){e.PrintTemplate="PRINT TEMPLATE",e.PrintResult="PRINT RESULT"}(ve||(ve={}));const pe=l=>{const n=t.hooks.useTranslate(h,t.defaultMessages),i=de([]),o=de([]),a=de(null),r=e.css`
    .classic-setting-con {
      height: 0;
    }
    .nav-bar-con {
      height: ${e.polished.rem(40)};
      border: none !important;
      border-bottom: 1px solid var(--light-200) !important;
      padding: 0;
      .navbar-nav button.nav-link, .navbar-nav button.nav-link:hover {
        color: var(--dark-800);
      }
      .jimu-nav-link-wrapper .jimu-badge-wrapper {
        & {
          display: block;
        }
        .badge-dot {
          top: ${e.polished.rem(4)};
          right: ${e.polished.rem(4)};
        }
      }
    }
  `,{config:s,jimuMapView:u,templateList:d,id:c}=l,[p,m]=ue(ve.PrintTemplate),[x,f]=ue((0,e.Immutable)([])),[b,j]=ue(null);ce((()=>{T(0)}),[]),ce((()=>{var t;if(b&&w(d,null==b?void 0:b.templateId)){const l=y(null==d?void 0:d.asMutable({deep:!0}),null==b?void 0:b.templateId),n=null===(t=M(null==d?void 0:d[l]))||void 0===t?void 0:t.asMutable({deep:!0});O(n),a.current=(0,e.Immutable)(n)}b&&w(d,null==b?void 0:b.templateId)||T(0)}),[d,s]);const O=t=>{var l;let n=null==b?void 0:b.asMutable({deep:!0});for(const e in n)e.includes("enable")&&delete n[e];const i=S(t,null===(l=a.current)||void 0===l?void 0:l.asMutable({deep:!0}));(null==i?void 0:i.length)>0&&i.forEach((l=>{var i;let o=t;l.forEach((e=>{o=o[e]})),n=null===(i=(0,e.Immutable)(n).setIn(l,o))||void 0===i?void 0:i.asMutable({deep:!0})})),n.customTextElementEnableList=null==t?void 0:t.customTextElementEnableList,n.selectedFormatList=null==t?void 0:t.selectedFormatList;const o=(0,e.Immutable)(Object.assign(Object.assign({},t),n));C(o)},S=(e,t)=>{const l=N(e,t);return I(l)},N=(e,t)=>{var l,n,i;if(!e||!t)return null;const o=[];for(const a in e){const r=e[a]instanceof Object;if(Array.isArray(e[a]))if(Array.isArray(t[a])&&(null===(l=e[a])||void 0===l?void 0:l.length)===(null===(n=null==t?void 0:t[a])||void 0===n?void 0:n.length)){const l=null===(i=e[a])||void 0===i?void 0:i.filter((e=>{var l;return!(null===(l=null==t?void 0:t[a])||void 0===l?void 0:l.includes(e))}));(null==l?void 0:l.length)>0&&o.push(a)}else o.push(a);else if(r){const l={},n=N(e[a],null==t?void 0:t[a]);l[a]=n,(null==n?void 0:n.length)>0&&o.push(l)}else(null==e?void 0:e[a])!==(null==t?void 0:t[a])&&o.push(a)}return o},I=(e,t)=>{let l=[];return null==e||e.forEach((n=>{const i=n instanceof Object,o=Array.isArray(n);let a=t||[];if(o)l=I(e,a);else if(i)Object.keys(n).forEach((e=>{a.push(e),a=I(n[e],a)})),l=a;else{const e=a.concat([n]);l.push(e)}})),l},T=e=>{if(0===(null==d?void 0:d.length))return!1;const t=M(null==d?void 0:d[e]);a.current=t,C(t)},M=t=>t?t=(null==t?void 0:t.overrideCommonSetting)?g((0,e.Immutable)(null==s?void 0:s.commonSetting),(0,e.Immutable)(t)):g((0,e.Immutable)(t),(0,e.Immutable)(null==s?void 0:s.commonSetting)):null,C=e=>{j(e)},P=t=>{m(t),t===ve.PrintResult&&(o.current=(0,e.Immutable)(i.current).asMutable())},L=e=>{const t=F(c,u.id),l=u.view.map.findLayerById(t);l&&(l.visible=e)},E=(t,l,n)=>{let o;n&&(t.url=n),t.state=l;const a=i.current;a.forEach(((e,l)=>{e.resultId===t.resultId&&(o=l)})),(o||0===o)&&(a.splice(o,1,t),f((0,e.Immutable)(a)),i.current=a)};return(0,e.jsx)("div",{className:"w-100 h-100 d-flex flex-column",css:r},(0,e.jsx)(t.Navbar,{className:"nav-bar-con w-100",border:!1,color:"false",light:!0},(0,e.jsx)(t.Nav,{className:"w-100 h-100",underline:!0,navbar:!0,justified:!0,fill:!0},(0,e.jsx)(t.NavItem,{title:n("printTemplate"),onClick:()=>{P(ve.PrintTemplate)},className:"link-con"},(0,e.jsx)(t.NavLink,{tag:"button",active:p===ve.PrintTemplate},n("printTemplate"))),(0,e.jsx)(t.NavItem,{title:n("printResult"),onClick:()=>{P(ve.PrintResult)}},(0,e.jsx)(t.NavLink,{tag:"button",active:p===ve.PrintResult},(0,e.jsx)(t.Badge,{className:"w-100 h-100",dot:!0,color:"primary",hideBadge:(null===(k=null==i?void 0:i.current)||void 0===k?void 0:k.length)===(null===(A=null==o?void 0:o.current)||void 0===A?void 0:A.length)},n("printResult")))))),(0,e.jsx)("div",{className:"flex-grow-1 w-100 classic-setting-con overflow-hidden"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"sr-only":p!==ve.PrintTemplate})},(0,e.jsx)(X,{id:c,config:s,jimuMapView:u,selectedTemplate:b,templateList:d,confirmPrint:t=>{return l=void 0,n=void 0,a=function*(){var l;const n={resultId:V((0,e.Immutable)(i.current)),url:null,title:z(null===(l=null==t?void 0:t.layoutOptions)||void 0===l?void 0:l.titleText,(0,e.Immutable)(i.current)),state:v.Loading},o=i.current;o.push(n),i.current=o,f((0,e.Immutable)(o)),L(!1),se({useUtility:null==s?void 0:s.useUtility,mapView:null==u?void 0:u.view,printTemplateProperties:yield B(t,u)}).then((e=>{L(!0),E(n,v.Success,null==e?void 0:e.url)}),(e=>{L(!0),E(n,v.Error)}))},new((o=void 0)||(o=Promise))((function(e,t){function i(e){try{s(a.next(e))}catch(e){t(e)}}function r(e){try{s(a.throw(e))}catch(e){t(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof o?l:new o((function(e){e(l)}))).then(i,r)}s((a=a.apply(l,n||[])).next())}));var l,n,o,a},handleSelectedTemplateChange:C,setSelectedTemplateByIndex:T})),p===ve.PrintResult&&(0,e.jsx)(re,{config:s,printResultList:x,deleteResultItem:t=>{var l,n;const a=i.current;a.splice(t,1),f((0,e.Immutable)(a)),i.current=null===(l=(0,e.Immutable)(a))||void 0===l?void 0:l.asMutable({deep:!0}),o.current=null===(n=(0,e.Immutable)(a))||void 0===n?void 0:n.asMutable({deep:!0})}})));var k,A};const me=t=>{const l=window.SVG,{className:n}=t,i=function(e,t){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(l[n[i]]=e[n[i]])}return l}(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return l?e.React.createElement(l,Object.assign({className:o,src:m()},i)):e.React.createElement("svg",Object.assign({className:o},i))},he=t=>{const l=e.css`
    &.print-loading-con {
      @keyframes loading {
        0% {transform: rotate(0deg); };
        100% {transform: rotate(360deg)};
      }
      width: ${e.polished.rem(16)};
      height: ${e.polished.rem(16)};
      border: 1px solid var(--dark-100);
      border-radius: 50%;
      border-top: 1px solid var(--dark-800);
      box-sizing: border-box;
      animation:loading 2s infinite linear;
      margin-right: ${e.polished.rem(4)};
    }
  `;return(0,e.jsx)("div",{css:l,className:"print-loading-con"})},xe=l=>{const n=t.hooks.useTranslate(h,t.defaultMessages),{prinResult:i,restPrint:o}=l,a=e.css`
    .error-link, .error-link:hover {
      color: var(--dark);
      & svg {
        color: var(--danger-800);
      }
    }
  `;return(0,e.jsx)("div",{className:"d-flex flex-column h-100 w-100",css:a},(0,e.jsx)(t.Button,{href:null==i?void 0:i.url,disabled:!(null==i?void 0:i.url),target:"_blank",size:"sm","aria-label":null==i?void 0:i.title,title:null==i?void 0:i.title,type:"tertiary",className:(0,e.classNames)("d-flex align-items-center",{"error-link":(null==i?void 0:i.state)===v.Error})},(()=>{switch(null==i?void 0:i.state){case v.Loading:return(0,e.jsx)(he,null);case v.Success:return(0,e.jsx)(ne,null);case v.Error:return(0,e.jsx)("span",{title:n("uploadImageError")},(0,e.jsx)(ae,null))}})(),(0,e.jsx)("div",{className:"ml-2"},null==i?void 0:i.title)),(0,e.jsx)("div",{className:"flex-grow-1 d-flex align-items-end"},(0,e.jsx)("div",{className:"flex-grow-1"}),(0,e.jsx)(t.Button,{type:"primary",onClick:o},n("reset"))))};const{useState:fe,useRef:ge,useEffect:ye}=e.React,{useSelector:be}=e.ReactRedux,we=l=>{var n,i;const{config:o,templateList:a,jimuMapView:r,errorTip:s,id:u}=l,d=t.hooks.useTranslate(h,t.defaultMessages),c=ge(null),p=be((e=>{var t,l;return null===(l=null===(t=null==e?void 0:e.appConfig)||void 0===t?void 0:t.widgets)||void 0===l?void 0:l[u]})),m=e.css`
    .compact-con {
      padding: 0;
      svg {
        margin: 0 auto;
      }
      .compact-icon {
        color: ${null===(i=null===(n=null==p?void 0:p.icon)||void 0===n?void 0:n.properties)||void 0===i?void 0:i.color};
      }
    }
  `,x=e.css`
    & {
      padding: ${e.polished.rem(12)};
      width: ${e.polished.rem(320)};
      height: ${e.polished.rem(155)};
    }
    .close-con button{
      padding: 0;
    }
    .result-list-con button {
      padding: 0;
    }
    .compact-preview-con {
      width: 0;
    }
  `,f=[{name:"preventOverflow",options:{altAxis:!0}},(0,t.getFallbackPlacementsModifier)(["left-start","left-end"],!0)],[b,j]=fe(!1),[O,S]=fe(!1),[N,I]=fe(null),[T,M]=fe(null);ye((()=>{C(0)}),[]),ye((()=>{if(T&&w(a,null==T?void 0:T.templateId)||C(0),T&&w(a,null==T?void 0:T.templateId)){const e=y(null==a?void 0:a.asMutable({deep:!0}),null==T?void 0:T.templateId);C(e)}}),[a,o]);const C=e=>{if(0===(null==a?void 0:a.length))return!1;let t=null==a?void 0:a[e];t=(null==t?void 0:t.overrideCommonSetting)?g(null==o?void 0:o.commonSetting,t):g(t,null==o?void 0:o.commonSetting),M(t)},P=(e,t)=>{j("clickOutside"!==t&&!b)},L=e=>{var t;const l=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value,n=y(null==a?void 0:a.asMutable({deep:!0}),l);C(n)},E=e=>{const t=F(u,r.id),l=r.view.map.findLayerById(t);l&&(l.visible=e)},k=()=>{return t=void 0,l=void 0,i=function*(){var t;const l={resultId:null==T?void 0:T.templateId,url:null,title:null===(t=null==T?void 0:T.layoutOptions)||void 0===t?void 0:t.titleText,state:v.Loading};I((0,e.Immutable)(l)),S(!O),E(!1),se({useUtility:null==o?void 0:o.useUtility,mapView:null==r?void 0:r.view,printTemplateProperties:yield B(T,r)}).then((t=>{l.url=null==t?void 0:t.url,l.state=v.Success,E(!0),I((0,e.Immutable)(l))}),(t=>{E(!0),l.state=v.Error,I((0,e.Immutable)(l))}))},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(a,r)}s((i=i.apply(t,l||[])).next())}));var t,l,n,i},A=()=>!r||!(null==o?void 0:o.useUtility);return(0,e.jsx)("div",{className:"w-100 h-100",css:m},(0,e.jsx)(t.Button,{className:"w-100 h-100 compact-con",type:"tertiary",ref:c,title:d("_widgetLabel"),onClick:P},(()=>{const l=null==p?void 0:p.icon;return l?"string"==typeof l?(0,e.jsx)(t.SVG,{src:l}):(0,e.jsx)(t.Icon,{className:"compact-icon",icon:null==l?void 0:l.svg}):(0,e.jsx)(me,null)})()),(0,e.jsx)(t.Popper,{open:b,disableResize:!0,placement:"bottom",reference:c,modifiers:f,showArrow:!0,toggle:P,trapFocus:!1,autoFocus:!1,css:x},!A()&&(0,e.jsx)("div",{className:"d-flex flex-column w-100 h-100"},(0,e.jsx)("div",{className:"text-right close-con"},(0,e.jsx)(t.Button,{className:"print-button",type:"tertiary",title:d("closeTour"),onClick:P},(0,e.jsx)(ee,null))),(0,e.jsx)("div",{className:"flex-grow-1"},(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"sr-only":O})},(()=>{var l;return(0,e.jsx)("div",{className:"d-flex flex-column"},(0,e.jsx)(R,{flowWrap:!0,className:"flex-grow-1",label:d("template")},(0,e.jsx)(t.Select,{value:null==T?void 0:T.templateId,onChange:L,size:"sm",className:"scalebar-unit","aria-label":d("template")},null==a?void 0:a.map(((l,n)=>(0,e.jsx)(t.Option,{key:l.templateId,value:l.templateId,title:l.label},l.label))))),(0,e.jsx)("div",{className:"print-button-con d-flex align-items-center mt-2"},(0,e.jsx)(D,{className:"flex-grow-1 compact-preview-con",id:u,jimuMapView:r,scale:null==T?void 0:T.outScale,selectedTemplate:T,scalebarUnit:null===(l=null==T?void 0:T.layoutOptions)||void 0===l?void 0:l.scalebarUnit,printExtentType:null==T?void 0:T.printExtentType}),(0,e.jsx)(t.Button,{className:"print-button text-truncate ml-1",type:"primary",onClick:k,title:d("_widgetLabel")},d("_widgetLabel"))))})()),O&&(0,e.jsx)(xe,{prinResult:N,restPrint:()=>{I(null),S(!1)}}))),A()&&(0,e.jsx)("div",null,s)))};function je(t){const l={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[n]=e;return n(t,l).then((e=>function(e){return t=this,l=void 0,i=function*(){let t=!1,l=!1;const n=(null==e?void 0:e.parameters)||[];let i=[],o=[],a="png32";return null==n||n.forEach((e=>{var n,r;if("Layout_Template"===e.name){const t=e.choiceList,l=e.defaultValue;t?i=null==t?void 0:t.map((e=>Oe(e))):i.push(Oe(l))}if("Format"===e.name){const t=null===(n=null==e?void 0:e.choiceList)||void 0===n?void 0:n.map((e=>null==e?void 0:e.toLowerCase()));a=null===(r=e.defaultValue)||void 0===r?void 0:r.toLowerCase(),o=t||[a]}"string"==typeof e.name&&"web_map_as_json"===e.name.toLowerCase()&&(t=!0),"string"==typeof e.name&&"output_file"===e.name.toLowerCase()&&(l=!0)})),Promise.resolve({templates:i,formatList:o,defaultFormat:a,hasWebmapParam:t,hasOutputParam:l})},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function r(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof n?l:new n((function(e){e(l)}))).then(a,r)}s((i=i.apply(t,l||[])).next())}));var t,l,n,i}(null==e?void 0:e.data)))}))}function Oe(e){const t=b(e)?{}:{layoutOptions:{legend:!1}};return Object.assign({label:e,layout:e,format:"PNG32"},t)}const Se=(t,l,n)=>{const i=Me(null==l?void 0:l.utilityId);return je(t).then((o=>{let a=n;const r=(null==o?void 0:o.templates)?((t,l,n)=>((e,t,l)=>{const n=((e,t)=>e===d.Customize||t===c.Customize?"custom":"org")(t,l);return e.map(((e,t)=>(e.templateId=`config_${n}_${t}`,e)))})(t.map((t=>{var l;let n=(0,e.Immutable)(t);return n=n.set("layout",null==t?void 0:t.layout),n=n.setIn(["layoutOptions","scalebarUnit"],"Miles").setIn(["layoutOptions","legendLayers"],null),b(null==n?void 0:n.layout)&&(n=n.set("exportOptions",Object.assign({width:800,height:1100},null==t?void 0:t.exportOptions))),null===(l=g((0,e.Immutable)(s),(0,e.Immutable)(n)))||void 0===l?void 0:l.asMutable({deep:!0})})),l,n))(null==o?void 0:o.templates,i,null==n?void 0:n.printTemplateType):[],u=null==r?void 0:r.map((e=>{var t;return(null==e?void 0:e.layout)&&(e.layout=null==e?void 0:e.layout),(null==e?void 0:e.format)&&(e.format=null===(t=null==e?void 0:e.format)||void 0===t?void 0:t.toLowerCase()),e}));return function(t){const l={query:{"env:outSR":"","env:processSR":"",returnZ:!1,returnM:!1,returnTrueCurves:!1,returnFeatureCollection:!1,context:"",f:"json"},responseType:"json"};return function(t){var l;if(!t)return Promise.resolve(null);const n=`${null===(l=t.split("/GPServer"))||void 0===l?void 0:l[0]}/GPServer`,i={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(n,i).then((e=>{var t,l;const i=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.tasks,o=null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.executionType,a=o===x.SynchronousExecute?"execute":"submitJob";let r=`${n}/Get Layout Templates Info Task/${a}`;return null==i||i.forEach((e=>{(null==e?void 0:e.includes("Templates"))&&(null==e?void 0:e.includes("Info"))&&(r=`${n}/${e}/${a}`)})),Promise.resolve({templatesInfoTaskUrl:`${n}/Get Layout Templates Info Task`,url:r,executionType:o})}))}))}(t).then((t=>{const{url:n,executionType:i,templatesInfoTaskUrl:o}=t;return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(n,l).then((e=>{var n,a,r;if(i===x.AsynchronousSubmit){const i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.jobId;return t(`${o}/jobs/${i}/results/Output_JSON`,l).then((e=>{var t;return Promise.resolve((null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.value)||[])}))}return Promise.resolve((null===(r=null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.results[0])||void 0===r?void 0:r.value)||[])}))}))}))}(t).then((e=>{const t=Ne(e,u),n=Te(null==o?void 0:o.templates,t);return a=a.set("printCustomTemplate",t).set("useUtility",l).set("formatList",null==o?void 0:o.formatList).set("defaultFormat",null==o?void 0:o.defaultFormat).set("layoutChoiceList",n),Promise.resolve(a)}))}))},Ne=(e,t)=>null==t?void 0:t.map((t=>{var l,n,i,o,a,r,s;let u;e.forEach((e=>{t.label===e.layoutTemplate&&(u=e)})),(null==u?void 0:u.webMapFrameSize)&&(t.mapFrameSize=null==u?void 0:u.webMapFrameSize,t.mapFrameUnit=null==u?void 0:u.pageUnits);const d=null===(n=null===(l=null==u?void 0:u.layoutOptions)||void 0===l?void 0:l.customTextElements)||void 0===n?void 0:n.map((e=>{const t={};for(const l in e)t[l]=!0;return t})),c=Ie(null==u?void 0:u.layoutOptions);return t.mapFrameUnit=null==u?void 0:u.pageUnits,t.hasAuthorText=null===(i=null==u?void 0:u.layoutOptions)||void 0===i?void 0:i.hasAuthorText,t.hasCopyrightText=null===(o=null==u?void 0:u.layoutOptions)||void 0===o?void 0:o.hasCopyrightText,t.hasLegend=null===(a=null==u?void 0:u.layoutOptions)||void 0===a?void 0:a.hasLegend,t.hasTitleText=null===(r=null==u?void 0:u.layoutOptions)||void 0===r?void 0:r.hasTitleText,t.selectedFormatList=[null==t?void 0:t.format],t.layoutOptions.customTextElements=(null===(s=null==u?void 0:u.layoutOptions)||void 0===s?void 0:s.customTextElements)||[],t.layoutOptions.elementOverrides=c,t.customTextElementEnableList=d||[],t.enableNorthArrow=!!N(c),t})),Ie=e=>{const t=(null==e?void 0:e.mapSurroundInfos)||[],l=null==t?void 0:t.find((e=>e.type===`${n}`)),i={};return l&&(i[null==l?void 0:l.name]=l),(null==e?void 0:e.elementOverrides)||i},Te=(e,t)=>(null==e?void 0:e.map((e=>(e.layoutTemplate=null==e?void 0:e.layout,null==t||t.forEach((t=>{(null==e?void 0:e.layout)===(null==t?void 0:t.layout)&&(e.mapFrameSize=null==t?void 0:t.mapFrameSize,e.mapFrameUnit=null==t?void 0:t.mapFrameUnit,e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText)})),e))))||[],Me=t=>{const l=e.UtilityManager.getInstance().getUtilityJson(t);return"org"===(null==l?void 0:l.source)?d.OrganizationService:d.Customize};class Ce extends e.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.10.0",description:"update layoutChoiceList of old print widget",upgrader:t=>{return l=this,n=void 0,o=function*(){const l=null==t?void 0:t.useUtility,n=t=>{var l,n,i,o,a,r;let s=(0,e.Immutable)(t);if(null===(l=null==t?void 0:t.exportOptions)||void 0===l?void 0:l.dpi){const e=Number(null===(n=null==t?void 0:t.exportOptions)||void 0===n?void 0:n.dpi);e<0?s=s.setIn(["exportOptions","dpi"],1):parseInt(e)!==e&&(s=s.setIn(["exportOptions","dpi"],parseInt(e)))}return(null===(i=null==t?void 0:t.exportOptions)||void 0===i?void 0:i.width)?Number(null===(o=null==t?void 0:t.exportOptions)||void 0===o?void 0:o.width)<1&&(s=s.setIn(["exportOptions","width"],800)):(null==t?void 0:t.layout)&&b(null==t?void 0:t.layout)&&(s=s.setIn(["exportOptions","width"],800)),(null===(a=null==t?void 0:t.exportOptions)||void 0===a?void 0:a.height)?Number(null===(r=null==t?void 0:t.exportOptions)||void 0===r?void 0:r.height)<1&&(s=s.setIn(["exportOptions","height"],1100)):(null==t?void 0:t.layout)&&b(null==t?void 0:t.layout)&&(s=s.setIn(["exportOptions","height"],1100)),null==s?void 0:s.asMutable({deep:!0})};if(t=(e=>{var t,l;return(null===(l=null===(t=null==e?void 0:e.commonSetting)||void 0===t?void 0:t.exportOptions)||void 0===l?void 0:l.dpi)?e.setIn(["commonSetting"],n(e.commonSetting)):e})(t),l){const e=yield(s=l,u=t,i=void 0,o=void 0,a=void 0,r=function*(){return j(s).then((e=>Se(e,s,u)))},new(a||(a=Promise))((function(e,t){function l(e){try{s(r.next(e))}catch(e){t(e)}}function n(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(l,n)}s((r=r.apply(i,o||[])).next())})));if(null==e?void 0:e.layoutChoiceList){const l=((e,t)=>{var l;const i=(null===(l=null==e?void 0:e.printCustomTemplate)||void 0===l?void 0:l.asMutable({deep:!0}))||[];return i?null==i?void 0:i.map((e=>{var l;if(null==e?void 0:e.mapFrameSize)return n(e);{const i=null===(l=null==t?void 0:t.filter((t=>(null==t?void 0:t.layout)===(null==e?void 0:e.layout))))||void 0===l?void 0:l[0],o={mapFrameSize:null==i?void 0:i.mapFrameSize,mapFrameUnit:null==i?void 0:i.mapFrameUnit,hasAuthorText:null==i?void 0:i.hasAuthorText,hasCopyrightText:null==i?void 0:i.hasCopyrightText,hasLegend:null==i?void 0:i.hasLegend,hasTitleText:null==i?void 0:i.hasTitleText};return Object.assign(Object.assign({},n(e)),o)}})):i})(t,null==e?void 0:e.layoutChoiceList);return t.setIn(["layoutChoiceList"],null==e?void 0:e.layoutChoiceList).set("printCustomTemplate",l)}return t}var i,o,a,r,s,u;return t},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function r(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var l;t.done?e(t.value):(l=t.value,l instanceof i?l:new i((function(e){e(l)}))).then(a,r)}s((o=o.apply(l,n||[])).next())}));var l,n,i,o}}]}}const Pe=new Ce,{useState:Le,useRef:Ee,useEffect:ke}=e.React,Ae=n=>{const{id:i,config:o,dispatch:a,useMapWidgetIds:r,layoutId:s,layoutItemId:v}=n,p=t.hooks.useTranslate(h,t.defaultMessages),x=e.ReactRedux.useSelector((e=>{var t;const l=null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.selection;return!(!l||l.layoutId!==s||l.layoutItemId!==v)})),f=Ee(!1),g=e.css`
    .jimu-widget-placeholder {
      border: none;
    }
    &.surface-1 {
      border: none !important;
    }
    .checkbox-con:hover {
      color: var(--dark-800);
    }
  `;ke((()=>{I()}),[x]),ke((()=>{N()}),[o]);const[y,b]=Le(null),[w,j]=Le(p("printPleaceholder")),[O,S]=Le(null),N=()=>{var e,t;const l=(e=null==o?void 0:o.printServiceType,t=null==o?void 0:o.printTemplateType,e===d.Customize||t===c.Customize?null==o?void 0:o.printCustomTemplate:null==o?void 0:o.printOrgTemplate);S(l)},I=()=>{s&&i&&v&&!f.current&&x&&(a(e.appActions.widgetStatePropChange(i,"layoutInfo",{layoutId:s,layoutItemId:v})),f.current=!0)},T=()=>{let e=w;return y&&!(null==o?void 0:o.useUtility)&&(e=""),e},M=()=>!y||!(null==o?void 0:o.useUtility);return(0,e.jsx)("div",{className:(0,e.classNames)("w-100 h-100",{"surface-1":(null==o?void 0:o.modeType)===u.Classic}),css:g},(0,e.jsx)("div",{className:"map"},(0,e.jsx)("div",null,(0,e.jsx)(l.JimuMapViewComponent,{useMapWidgetId:null==r?void 0:r[0],onActiveViewChange:e=>null==e||"2d"!==e.view.type?(j(p("chooseMapTip")),void b(null)):(r&&0!==(null==r?void 0:r.length)||j(p("printPleaceholder")),void b(e)),onViewGroupCreate:e=>{}}))),(null==o?void 0:o.modeType)===u.Classic&&(0,e.jsx)("div",{className:"w-100 h-100"},!M()&&(0,e.jsx)(pe,{id:i,config:o,jimuMapView:y,templateList:O}),M()&&(0,e.jsx)(t.WidgetPlaceholder,{icon:m(),widgetId:i,message:T()})),(null==o?void 0:o.modeType)===u.Compact&&(0,e.jsx)("div",{className:"w-100 h-100"},(0,e.jsx)(we,{id:i,config:o,jimuMapView:y,templateList:O,errorTip:T()})))};Ae.versionManager=Pe;const Re=Ae})(),a})())}}}));